{% extends "_base_landing.html"%}
{% block content %}
<div class="container-fluid">
    <div id="hp-content">
        <div class="wrapper">
            {{novinky}}

            {% if stage(config.YEAR, 'PROGRAM') %}
                {% include '_program.html' %}
            {% endif %}

            <!-- {% if stage(config.YEAR, 'USERS') %}
                <h2>Moje účast</h2>
                {% if going(user, config.YEAR) %}
                    <p class="menu center menu-button"><a class="gray" href="{{url_for('attend_remove')}}">
                            <i class="icon-remove icon-white"></i>
                            Už nechci přijít</a>
                {% else %}
                    <a name="go"></a>
                    <p class="menu center menu-button"><a href="{{url_for('attend_add')}}">
                            <i class="icon-heart icon-white"></i>
                            Chci přijít na Barcamp</a>
                </p><div class="clearer"></div>
                {% endif %}
            {% else %}
                <h2>Kdy budou registrace účastníků?</h2>
                <p></p>
                <p class="menu center menu-button"><a href="{{url_for('static_page', page='informace')}}">
                        <i class="icon-bullhorn icon-white"></i>
                        Registrace účasti začnou 1. 5. 2016</a>
                </p>
            {% endif %} -->
            {% if stage(config.YEAR, 'CALL-FOR-PAPERS') or after_stage(config.YEAR, 'CALL-FOR-PAPERS') %}
                <!-- prednasejici -->
                <h2>Program{% if stage(config.YEAR, 'VOTING') %} &amp; hlasování{% endif %}</h2>
                
                {% if going(user, config.YEAR) %}    
                <form method="POST" action="{{url_for('vote_save')}}">
                {% endif %}
                <h3>Témata volená účastníky <small>(42 míst)</small></h3>
                <table class="table" id="talks">
                    {% for talk in talks %}
                        <tr class="{{'fail' if loop.index > 42 and after_stage(config.YEAR, 'VOTING') }}">
                            <th>
                                {% if after_stage(config.YEAR, 'VOTING') %}
                                <span class="number">{{loop.index}}.</span> {% endif %} 
                                <a href="{{url_for('talk_detail', talk_hash=talk.talk_hash)}}">{{talk.title}}</a>
                            </th>
                            <td class="shadow-name">{{talk.user.name}}</td>
                            {% if stage(config.YEAR, 'VOTING') or after_stage(config.YEAR, 'VOTING') %}
                                <td>Počet&nbsp;hlasů&nbsp;<strong>{{talk.score or 0|int}}</strong></td>
                            {% endif %}
                            {% if going(user, config.YEAR) and stage(config.YEAR, 'VOTING') %}
                                <td><label><input
                                    type="checkbox"
                                    {{'checked' if talk.talk_hash in user_votes}}
                                    name="{{talk.talk_hash}}"/> 
                                    Chci vidět</label>
                                </td>
                            {% endif %}
                        </tr>
                    {% else %}
                        <div>Zatím zde nic není</div>
                    {% endfor %}

                    {% if going(user, config.YEAR) and stage(config.YEAR, 'VOTING') %}
                    <tr>
                        <td colspan="3"></td>
                        <td><input type="submit" id="save-button" value="Uložit hlasy"></td>
                    </tr>
                    {% elif stage(config.YEAR, 'VOTING') %}
                    <tr>
                        <td colspan="2"></td>
                        <td>
                            <p class="alert alert-danger">Hlasovat mohou jen ti, kteří chtějí přijít. (<a href="#go">přihlášení dole</a>)</p>
                        </td></tr>
                    {% endif %}
                    {% if after_stage(config.YEAR, 'VOTING') %}
                    <tr>
                        <td colspan="4">
                            <p class="alert alert-danger pull-right">Hlasování bylo ukončeno.</p>
                        </td></tr>
                    {% endif %}
                </table>
                {% if going(user, config.YEAR) %}
                </form>
                {% endif %}
                
                {% if stage(config.YEAR, 'CALL-FOR-PAPERS') %}
                <p class="menu center menu-button"><a href="{{url_for('talk_edit')}}">
                            <i class="icon-bullhorn icon-white"></i>
                            Máš co říct? Přidej své téma</a>
                </p><div class="clearer"></div>
                {% endif %}
            {% endif %}

            {% if stage(config.YEAR, 'CALL-FOR-WORKSHOPS') or after_stage(config.YEAR, 'CALL-FOR-WORKSHOPS') %}
                <h2>Přihlášené workshopy</h2>
                 <table class="table" id="workshops">
                    {% for workshop in workshops %}
                        <tr class="{% if workshop.status != 'approved' %}fail{% endif %}">
                            <th>
                                <a href="{{url_for('workshop_detail', workshop_hash=workshop.workshop_hash)}}">{{workshop.title}}</a>
                            </th>
                            <td>{{workshop.user.name}}</td>
                            <td class="shadow-name">{{status(workshop.status)}}</td>
                        </tr>
                    {% else %}
                        <div>Zatím zde nic není</div>
                    {% endfor %}
                </table>
                {% if stage(config.YEAR, 'CALL-FOR-WORKSHOPS') %}
                <p class="menu center menu-button"><a href="{{url_for('workshop_edit')}}">
                            <i class="icon-bullhorn icon-white"></i>
                            Chceš udělat na Barcampu workshop? Přidej ho!</a>
                </p><div class="clearer"></div>
                {% endif %}
            {% endif %}


            <!-- workshopy -->
            <!-- {{ workshops }} -->

            <!-- sponzori -->
            <!-- <h2>Hlavní partneři akce</h2>
            <p class="sponsors">
                {{sponsors_main}}
            </p>
            
            <h2>Partneři akce</h2>
            <p class="sponsors">
                {{sponsors}}
            </p>

            <h2>Mediální partneři</h2>
            <p class="sponsors">
                {{sponsors_medial}}
            </p> -->
            <!-- / sponzori -->

            {% if stage(config.YEAR, 'USERS') %}
                <a name="entrants"></a>
                <h2>Účastníci</h2>
                <p>Právě je přihlášeno <strong>{{entrant_count}}</strong> účastníků.</p>
                <a href="{{url_for('entrants')}}">Kompletní seznam účastníků</a>
                
                {% if entrants %}
                <ul id="entrants">
                {% for entrant in entrants %}
                    <li><a href="{{url_for('profile', user_hash=entrant.user_hash)}}">{{entrant.name}}</a></li>
                {% endfor %}
                    <li>... <a href="{{url_for('entrants')}}"> a spousta dalších</a></li>
                </ul>
                {% endif %}
            
                {% if going(user, config.YEAR) %}
                    <p class="menu center menu-button"><a class="gray" href="{{url_for('attend_remove')}}">
                            <i class="icon-remove icon-white"></i>
                            Už nechci přijít</a>
                {% else %}
                    <a name="go"></a>
                    <p class="menu center menu-button"><a href="{{url_for('attend_add')}}">
                            <i class="icon-heart icon-white"></i>
                            Chci přijít na Barcamp</a>
                </p><div class="clearer"></div>
                {% endif %}
            {% endif %}
            
            </p>
        </div>
    </div>
</div>
{% endblock %}