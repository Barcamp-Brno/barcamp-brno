{% extends "_base.html"%}
{% block body %}
<div id="hp-header">
    <div class="wrapper">
        <h1>Barcamp Brno {{config.YEAR}}</h1>
        <h2>31 | 05 | {{config.YEAR}} | Brno</h2>
        <h3><a href="http://mapy.cz/s/6ZKC">VUT FIT, Božetěchova 2</a></h3>
        <div class="clearer" style="height: 40px;"></div>
        {% include "menu.html"%}
        <div class="clearer"></div>
    </div>
</div> <!-- hp-head-->
<div id="hp-content">
    <div class="wrapper">
        {{novinky}}
{% if "PROGRAM_READY" in config.STAGES %}
<h2>Program Barcampu</h2>
<h3>Sobota 31.5.{{config.YEAR}}</h3>
<ul>
    <li><a href="{{url_for('static_page', page='doprovodny-program')}}">Bohatý doprovodný program</a></li>
    <li><a href="{{url_for('static_page', page='charita')}}">Dobročinná sbírka</a></li>
</ul>
<table class="table table-condensed">
<tr>
    <th></th>
    <th style="text-align: center">D105</th>
    <th style="text-align: center">E112</th>
    <th style="text-align: center">D0206</th>
    <th style="text-align: center">D0207</th>
    <th style="text-align: center">E104</th>
</tr>
<tr>
    <th></th>
    <th style="text-align: center">Superman</th>
    <th style="text-align: center">Batman</th>
    <th style="text-align: center">Wonder Woman</th>
    <th style="text-align: center">Flash</th>
    <th style="text-align: center">Green Lantern</th>
</tr>
<tr>
    <th>Moderuje</th>
    <th style="text-align: center">Michal Holub</th>
    <th style="text-align: center">Martin Kopta</th>
    <th style="text-align: center">Julie Haladová</th>
    <th style="text-align: center">Aleš Vrána</th>
    <th style="text-align: center">Luboš Louženský</th>
</tr>
{% for t in times %}
<tr class="{{'success' if not t.data.items}}">
    <th>{{t.block_from.strftime('%H:%M')}}&mdash;{{t.block_to.strftime('%H:%M')}}</th>
    {% if t.data.items %}
        {{format_talk_td(t.data.d105)}}
        {{format_talk_td(t.data.e112)}}
        {{format_talk_td(t.data.d0206)}}
        {{format_talk_td(t.data.d0207)}}
        {{format_talk_td(t.data.e105)}}
    {% else %}
        <td colspan="5" style="text-align: center; vertical-align: middle">{{t.data}}</td>
    {% endif %}
</tr>
{% endfor %}
</table>
{% endif %}
        
        {% if "INTRO" in config.STAGES %}
            <h2>Kdy budou registrace účastníků?</h2>
            <p></p>
            <p class="menu center menu-button"><a href="/2014/stranka/informace.html">
                    <i class="icon-bullhorn icon-white"></i>
                    Registrace účasti začnou 1.5.2014.</a>
        </p>
        {% endif %}

        <!-- prednasejici -->
        <h2>Přednášející{% if "VOTING" in config.STAGES %} &amp; hlasování{% endif %}</h2>
        
        {% if user and user['going_%s' % config.YEAR] %}    
        <form method="POST" action="{{url_for('vote_save')}}">
        {% endif %}
        {% for data in (extra_talks, talks) %}
            {% if loop.index == 1%}
                <h3>Barcamp zve <small><a href="{{url_for('static_page', page='barcamp-zve')}}">Co je to?</a></small></h3>
            {% else %}
                <h3>Volený program <small>(28 míst)</small></h3>
            {% endif %}
            <table class="table" id="talks">
                {% for talk in data %}
                <tr class="{{'fail' if loop.index > 28 and 'VOTING' in config.STAGES }}">
                    <th>
                        {% if "VOTING" in config.STAGES %}
                        <span class="number">{{loop.index}}.</span> {% endif %} {{talk.user.name}}</th>
                    <td><a href="{{url_for('talk_detail', talk_hash=talk.talk_hash)}}">{{talk.title}}</a></td>
                    {% if "VOTING" in config.STAGES%}
                        <td>Počet hlasů <strong>{{talk.score or 0|int}}</strong></td>
                    {% endif %}
                    {#% if user and user['going_%s' % config.YEAR] %}
                        <td><label><input
                            type="checkbox"
                            {{'checked' if talk.talk_hash in user_votes}}
                            name="{{talk.talk_hash}}"/> 
                            Chci vidět</label>
                        </td>
                    {% endif %#}
                </tr>
                {% else %}
                    <div>Zatím zde nic není</div>
                {% endfor %}
                {% if user and user['going_%s' % config.YEAR] and "VOTING" in config.STAGES%}
                <tr>
                    <td colspan="3"></td>
                    <td><input type="submit" id="save-button" value="Uložit hlasy"></td>
                </tr>
                {% elif "VOTING" in config.STAGES %}
                <tr>
                    <td colspan="2"></td>
                    <td>
                        <p class="alert alert-danger">Hlasovat mohou jen ti, kteří chtějí přijít. (<a href="#go">přihlášení dole</a>)</p>
                    </td></tr>
                {% endif %}
                {% if "VOTING_END" in config.STAGES%}
                <tr>
                    <td colspan="4">
                        <p class="alert alert-danger pull-right">Hlasování bylo ukončeno.</p>
                    </td></tr>
                {% endif %}
            </table>
        {% endfor %}
        {% if user and user['going_%s' % config.YEAR] %}
        </form>
        {% endif %}
        
        {% if "REGISTER_TALKS" in config.STAGES %}
        <p class="menu center menu-button"><a href="{{url_for('static_page', page='pro-prednasejici')}}">
                    <i class="icon-bullhorn icon-white"></i>
                    Máš co říct? Přidej své téma</a>
        </p><div class="clearer"></div>
        {% endif %}

        <!-- sponzori -->
        <h2>Hlavní partneři akce</h2>
        <p class="sponsors">
            {{sponsors_main}}
        </p>
		
		<h2>Partneři akce</h2>
        <p class="sponsors">
            {{sponsors}}
        </p>
        <!-- / sponzori -->
        {% if "USERS" in config.STAGES %}
            <a name="entrants"></a>
            <h2>Účastníci</h2>
            <p>Právě je přihlášeno <strong>{{entrant_count}}</strong> účastníků.</p>
            <a href="{{url_for('entrants')}}">Seznam účastníků</a>
            
            {#% if entrants %}
            <ul id="entrants">
            {% for entrant in entrants %}
                <li><a href="{{url_for('profile', user_hash=entrant.user_hash)}}">{{entrant.name}}</a></li>
            {% endfor %}
                <li>... <a href="{{url_for('entrants')}}"> a spousta dalších</a></li>
            </ul>
            {% endif %#}
        
            {% if user and user['going_%s' % config.YEAR] %}
                <p class="menu center menu-button"><a class="gray" href="{{url_for('attend_remove')}}">
                        <i class="icon-remove icon-white"></i>
                        Už nechci přijít</a>
            {% else %}
                <a name="go"></a>
                <p class="menu center menu-button"><a href="{{url_for('attend_add')}}">
                        <i class="icon-heart icon-white"></i>
                        Chci přijít na Barcamp</a>
            </p><div class="clearer"></div>
            {% endif %}
        {% endif %}
        
        </p><div class="clearer"></div>
    </div>
</div>
<div class="clearer"></div>
<!-- pata -->
<div id="footer">
    <div class="wrapper">
        <div>
            &copy; Barcamp Brno {{config.YEAR}} &mdash; <a href="{{url_for('static_page', page='kontakty')}}">Kontakty</a>
        </div>
    </div>
</div>
{% endblock %}
{% macro format_talk_td(hash) -%}
{% if hash %}
<td style="text-align: center">
    <p>
        <strong>{{talks[hash].user.name}}</strong><br />
        <small><a href="{{url_for('talk_detail', talk_hash=hash)}}">{{talks[hash].title|truncate(64)}}</a></small>
    </p>
</td>
{% else %}
<td style="vertical-align: middle; text-align: center;">Warm-up party na přednášku o technu</td>
{% endif %}
{%- endmacro %}
